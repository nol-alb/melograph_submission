{% extends 'layout.html' %}
{% block body %}
<!doctype html>
<html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.20.0/cytoscape.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/dagre/0.8.5/dagre.min.js" integrity="sha512-psLUZfcgPmi012lcpVHkWoOqyztollwCGu4w/mXijFMK/YcdUdP06voJNVOJ7f/dUIlO2tGlDLuypRyXX2lcvQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<head>
    <title>Tutorial 1: Getting Started</title>
    <style>
        #cy {
        width: 80%;
        height: 80%;
        position: absolute;
        top: 0px;
        left: 0px;
        }
    </style>
</head>

<body>
    <div>
        <h3>
            <center>Rendered graph</center>
        </h3>
    </div>
    <div class="row">
    </div>
    <div class="row" style="height: 1000pt">
        <!-- <div class="col col-lg-1"></div> -->
        <div class="col col-lg-12">
            <div id="cy"></div>
        </div>
        <!-- <div class="col col-lg-1"></div> -->
    </div>
    <!-- <script type="text/json" src="/Users/rhythmjain/Desktop/GTStuff/1-2/AudioContent/melograph/graphFinal/melograph/WebApp/templates/data.json"></script> -->
    <script type="text/javascript">
    path = 'data.json'

    fetch(path)
        .then(response => response.json())
        .then(data => {
            console.log(data)

            console.log("Within function")
            node = data["nodes"]
            console.log(node);
            edges = data["edges"]
            console.log(edges);
            var cy = cytoscape({
                container: document.getElementById('cy'),
                style: [{
                        selector: 'node',
                        'css': {
                            'content': 'data(name)',
                            'text-valign': 'center',
                            'color': 'white',
                            'text-outline-width': 2,
                            'text-outline-color': 'data(color)',
                            'background-color': 'data(color)',
                            'shape': 'data(type)',
                            width: 'data(weight)',
                            height: 'data(weight)'
                        }
                    },
                    {
                        selector: "edge",
                        style: {
                            width: 'data(weight)',
                            "target-arrow-shape": "triangle",
                            'line-color': 'black',
                            'target-arrow-color': 'black',
                            'source-arrow-color': 'black',

                        }
                    },
                    {
                        'selector': ':selected',
                        'css': {
                            'background-color': 'black',
                            'line-color': 'black',
                            'target-arrow-color': 'black',
                            'source-arrow-color': 'black',
                            'text-outline-color': 'black'
                        }
                    }
                ],
                elements: {
                    nodes: node,
                    edges: edges
                },
                layout: {
                    name: 'cose',
                    idealEdgeLength: 100,
                    nodeOverlap: 20,
                    refresh: 20,
                    fit: true,
                    padding: 30,
                    randomize: false,
                    componentSpacing: 100,
                    nodeRepulsion: 400000,
                    edgeElasticity: 100,
                    nestingFactor: 5,
                    gravity: 80,
                    numIter: 1000,
                    initialTemp: 200,
                    coolingFactor: 0.95,
                    minTemp: 1.0
                },
            });


            cy.layout({
                name: 'cose',
                idealEdgeLength: 100,
                nodeOverlap: 20,
                refresh: 20,
                fit: true,
                padding: 30,
                randomize: false,
                componentSpacing: 100,
                nodeRepulsion: 400000,
                edgeElasticity: 100,
                nestingFactor: 5,
                gravity: 80,
                numIter: 1000,
                initialTemp: 200,
                coolingFactor: 0.95,
                minTemp: 1.0
            }).run();
            cy.style()
                .selector('node')
                .style('border', '100pt')

            console.log("after running")
        })
    </script>
</body>

</html>
{% endblock %}